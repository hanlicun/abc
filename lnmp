LNMP 软件版本 Linux: Ubuntu Zesty Zapus PHP: 7.1.1 Tengine-2.2.0(Nginx: 1.11.10) MySQL: 5.7.10 安装准备
apt-get update apt-get install   gcc g++ -y mkdir -p  /usr/local/webserver/nginx mkdir -p  /usr/local/webserver/php
创建用户组和用户 /usr/sbin/groupadd oae useradd -r -m -s /bin/bash -g oae  oae
安装Tengine 安装准备
apt-get install build-essential libtool libpcre3 libpcre3-dev openssl libssl-dev wget http://tengine.taobao.org/download/tengine-2.2.0.tar.gz tar zxvf tengine-2.2.0.tar.gz cd tengine-2.2.0
配置
./configure --prefix=/usr/local/webserver/tengine --user=oae--group=oae --with-http_stub_status_module --with-http_ssl_module --with-file-aio --with-http_realip_module --without-http_rewrite_module --with-openssl=/usr --with-zlib=/usr
编译安装
make make install
nginx.conf配置
server {         listen       80;         server_name  localhost;         charset utf-8;      root  /home/oae/web/wwwroot/public/;         location / {             index  index.php  index.html index.htm;             try_files $uri  $uri/ /index.php?$query_string;         }         location ~ \.php$ {          fastcgi_pass   unix:/var/run/php-fpm.sock;             fastcgi_index  index.php;             fastcgi_param  SCRIPT_FILENAME  $document_root$fastcgi_script_name;             include        fastcgi_params;         } }
安装Nginx 依赖关系
apt-get install build-essential libtool libpcre3 libpcre3-dev openssl libssl-dev
配置
./configure --prefix=/usr/local/webserver/nginx --user=oae--group=oae--with-http_stub_status_module --with-http_ssl_module --with-file-aio --with-http_realip_module
安装
make  && make install
配置nginx .conf
location ~ \.php$ {     #fastcgi_pass   127.0.0.1:9000;     fastcgi_pass   unix:/var/run/php-fpm.sock;     fastcgi_index  index.php;     fastcgi_param  SCRIPT_FILENAME $document_root$fastcgi_script_name;     include        fastcgi_params; }
安装PHP7 安装依赖
apt-get install libxml2-dev libcurl4-gnutls-dev libjpeg-dev libpng-dev libmcrypt-dev libreadline6 libreadline6-dev libfreetype6-dev
缺少了openssl解决: ln -s /lib/x86_64-linux-gnu/libssl.so.1.0.0 /usr/lib/libssl.so wget http://cn2.php.net/get/php-7.1.2.tar.gz/from/this/mirror tar zxvf mirror cd php-7.1.2
配置
./configure --prefix=/usr/local/webserver/php --with-config-file-path=/usr/local/webserver/php/etc --enable-fpm --with-fpm-user=oae --with-fpm-group=oae --with-mysqli --with-pdo-mysql --with-iconv-dir --with-freetype-dir --with-jpeg-dir --with-png-dir --with-zlib --with-libxml-dir=/usr --enable-xml --disable-rpath --enable-bcmath --enable-shmop --enable-sysvsem --enable-inline-optimization --with-curl --enable-mbregex --enable-mbstring --with-mcrypt --enable-ftp --with-gd --enable-gd-native-ttf --with-openssl --with-mhash --enable-pcntl --enable-sockets --with-xmlrpc --enable-zip --enable-soap --without-pear --with-gettext --disable-fileinfo --enable-maintainer-zts
编译
make -j4
测试
make test
安装
make install 编辑 /etc/enviornment, 将 /usr/local/php/bin 添加到 PATH 变量, 然后用 source /etc/environment 更新。
配置php.ini
cp <source-dir>/php.ini-development /usr/local/webserver/php/etc/php.ini
配置php-fpm.conf
mv /usr/local/php/etc/php-fpm.conf.default /usr/local/webserver/php/etc/php-fpm.conf
配置 www.conf
mv /usr/local/php/etc/php-fpm.d/www.conf.default /usr/local/webserver/php/etc/php-fpm.d/www.conf
;listen = 127.0.0.1:9000 listen = /var/run/php-fpm.sock
listen.owner = oae listen.group = oae listen.mode = 0666
pm = dynamic
初始化php-fpm服务脚本
cp <source-dir>/sapi/fpm/init.d.php-fpm.in /etc/init.d/php-fpm chmod 755 /etc/init.d/php-fpm
修改该文件内容 prefix= exec_prefix= php_fpm_BIN=/usr/local/webserver/php/sbin/php-fpm php_fpm_CONF=/usr/local/webserver/php/etc/php-fpm.conf php_fpm_PID=/var/run/php-fpm.pid
安装MYSQL5.7
apt-get install mysql-server
安装PHP扩展 redis扩展
git clone https://github.com/phpredis/phpredis.git cd phpredis /usr/local/webserver/php/bin/phpize ./configure --with-php-config=/usr/local/webserver/php/bin/php-config make make install
vi /usr/local/webserver/php/etc/php.ini
extension_dir = "/usr/local/webserver/php/lib/php/extensions/no-debug-zts-20160303/" extension  =redis.so
mongodb扩展 依赖管理
apt-get install libbson-1.0 apt-get install libmongoc-1.0-0
配置
wget https://pecl.php.net/get/mongodb-1.2.5.tgz tar zxvf mongodb-1.2.5.tgz /usr/local/webserver/php/bin/phpize ./configure --with-php-config=/usr/local/webserver/php/bin/php-config
编译安装
make make install
php.ini配置
vi /usr/local/webserver/php/etc/php.ini extension =mongodb.so
memcached 依赖安装
wget https://launchpad.net/libmemcached/1.0/1.0.18/+download/libmemcached-1.0.18.t ar.gz tar zxvf libmemcached-1.0.18.tar.gz cd libmemcached-1.0.18 mkdir -p /usr/local/webserver/libmemcached ./configure=/usr/local/webserver/libmemcached make && make install
配置
wget https://pecl.php.net/get/memcached-3.0.2.tgz tar zxvf memcached-3.0.2.tgz cd memcached /usr/local/webserver/php/bin/phpize ./configure --enable-memcached --with-php-config=/usr/local/webserver/php/bin/php-config --with-libmemcached-dir=/usr/local/webserver/libmemcached --disable-memcached-sasl
编译安装
make && make install
php.ini配置
vi /usr/local/webserver/php/etc/php.ini extension =memcached.so
gearman扩展(版本号：2.0.3) 依赖安装
apt-get install gearman-job-server apt-get -y install libgearman-dev
配置
wget https://github.com/wcgallego/pecl-gearman/archive/master.zip unzip master.zip cd pecl-gearman-master /usr/local/webserver/php/bin/phpize ./configure --prefix=/usr/local/webserver/gearman --with-php-config=/usr/local/webserver/php/bin/php-config
编译安装
make && make install
php.ini配置
vi /usr/local/webserver/php/etc/php.ini extension =gearman.so
kafka
安装依赖
#apt-get install python git clone  https://github.com/edenhill/librdkafka.git cd  librdkafka ./configure make && make install
配置
git clone https://github.com/arnaud-lb/php-rdkafka.git cd php-rdkafka /usr/local/webserver/php/bin/phpize ./configure --with-php-config=/usr/local/webserver/php/bin/php-config
编译安装
make all -j 5 make install
php.ini配置
vi /usr/local/webserver/php/etc/php.ini extension=rdkafka.so 
xhprof( ) php7.0+暂不支持或不稳定 配置
git clone https://github.com/longxinH/xhprof.git  longxinH cd  longxinH/extension /usr/local/webserver/php/bin/phpize
编译安装
./configure --with-php-config=/usr/local/webserver/php/bin/php-config make make install
配置php.ini
[xhprof] extension = xhprof.so xhprof.output_dir = /tmp/xhprof 
xdebug
配置
wget  https://pecl.php.net/get/xdebug-2.5.0.tgz tar zxvf  xdebug-2.5.0.tgz cd xdebug-2.5.0
编译安装
/usr/local/webserver/php/bin/phpize ./configure --enable-xdebug --with-php-config=/usr/local/webserver/php/bin/php-config make make install
配置php.ini
vi /usr/local/webserver/php/etc/php.ini zend_extension=xdebug.so  重新编译php './configure' '--prefix=/usr/local/webserver/php' '--with-config-file-path=/usr/local/webserver/php/etc' '--enable-fpm' '--with-fpm-user=oae' '--with-fpm-group=oae' '--with-mysqli' '--with-pdo-mysql' '--with-iconv-dir' '--with-freetype-dir' '--with-jpeg-dir' '--with-png-dir' '--with-zlib' '--with-libxml-dir=/usr' '--enable-xml' '--disable-rpath' '--enable-bcmath' '--enable-shmop' '--enable-sysvsem' '--enable-inline-optimization' '--with-curl' '--enable-mbregex' '--enable-mbstring' '--with-mcrypt' '--enable-ftp' '--with-gd' '--enable-gd-native-ttf' '--with-openssl' '--with-mhash' '--enable-pcntl' '--enable-sockets' '--with-xmlrpc' '--enable-zip' '--enable-soap' '--without-pear' '--with-gettext' '--disable-fileinfo' '--enable-maintainer-zts' '--enable-debug'
opcache 配置
wget https://pecl.php.net/get/zendopcache-7.0.5.tgz tar zxvf zendopcache-7.0.5.tgz cd zendopcache-7.0.5
编译安装
/usr/local/webserver/php/bin/phpize ./configure --prefix=/usr/local/webserver/zmq --with-php-config=/usr/local/webserver/php/bin/php-config  make make install
配置php.ini
vi /usr/local/webserver/php/etc/php.ini zend_extension = opcache.so
zmq
安装依赖
git clone https://github.com/zeromq/libzmq ./autogen.sh && ./configure && make -j 4 make check && make install && ldconfig
配置
wget https://pecl.php.net/get/zmq-1.1.3.tgz /usr/local/webserver/php/bin/phpize ./configure --prefix=/usr/local/webserver/zmq --with-php-config=/usr/local/webserver/php/bin/php-config 
编译安装
make make install
php.ini配置
vi /usr/local/webserver/php/etc/php.ini extension =zmq.so
安装composer
# vi /etc/environment 添加 /usr/local/webserver/php/bin: $ curl -s http://getcomposer.org/installer| php $ mv composer.phar /usr/local/bin/composer #设置国内镜像 $ composer config -g repo.packagist composer https://packagist.phpcomposer.com
安装git
apt-get install git
